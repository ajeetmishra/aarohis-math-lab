<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ishi's Universal Converter</title>
    <style>


		/* Ensure the main area never grows beyond the screen */
		#main-area {
			height: 100vh;
			width: 100vw;
			display: flex;
			align-items: center;
			justify-content: center;
			overflow: hidden; /* Prevents scrolling */
			position: relative;
		}

		/* Make the card responsive rather than fixed height */
		#card {
			max-height: 85vh; /* Never more than 85% of screen height */
			max-width: 90vw;  /* Never more than 90% of screen width */
			height: auto;     /* Let content define height up to the max */
			min-height: 300px;
			padding: 20px;
			box-sizing: border-box; /* Includes padding in height calculation */
		}

		/* Ensure the answer doesn't push elements off-screen */
		#answer {
			margin-top: 10px;
			line-height: 1;
		}


		/* --- RESPONSIVE MOBILE-FIRST OVERRIDES --- */
		@media (max-width: 768px) {
			body {
				flex-direction: column; /* Stack sidebar and main area */
				overflow: auto;
			}

			#sidebar {
				position: fixed;
				left: -100%; /* Hide off-screen by default */
				top: 0;
				bottom: 0;
				width: 80%; /* Take most of the screen when open */
				transition: 0.3s ease;
				z-index: 2000;
				box-shadow: 10px 0 30px rgba(0,0,0,0.2);
			}

			#sidebar.open {
				left: 0; /* Slide in */
			}

			#main-area {
				width: 100vw;
				height: 100vh;
				padding: 10px;
			}

			#card {
				width: 95%;
				height: 70vh; /* Scaled to screen height */
				margin-top: 50px;
			}

			/* Floating Toggle Button for Settings */
			#menu-toggle {
				display: block !important;
				position: fixed;
				top: 15px;
				left: 15px;
				z-index: 3000;
				background: var(--accent-color);
				color: white;
				border: none;
				padding: 10px 15px;
				border-radius: 8px;
				font-weight: bold;
			}

			/* Mobile responsive text */
			.desktop-text { display: none !important; }
			.mobile-text { display: inline !important; }

			/* Mobile navigation - all buttons in one horizontal row */
			#nav-icons {
				right: 15px !important;
				top: 15px !important;
				flex-direction: row !important;
				flex-wrap: wrap !important;
				gap: 5px !important;
			}

			/* Smaller padding and font size for mobile buttons */
			#nav-icons a, #nav-icons button {
				padding: 8px 10px !important;
				font-size: 0.8rem !important;
			}

			/* Adjust large text for small screens */
			#problem, #problem-text { font-size: 3rem !important; }
			#answer { font-size: 2.5rem !important; }
		}

		/* Hide navigation button text on very small screens */
		@media (max-width: 480px) {
			.nav-text {
				display: none !important;
			}
		}

		/* Desktop responsive text - hide mobile text by default */
		.mobile-text { display: none; }
		.desktop-text { display: inline; }

		/* Hide toggle on desktop */
		#menu-toggle { display: none; }


        :root {
            --bg-color: #fff5f8; /* Soft pink theme for tailoring/design */
            --sidebar-bg: #ffffff;
            --card-bg: #ffffff;
            --accent-color: #d81b60;
            --text-main: #4a001f;
            --text-muted: #ad1457;
            --logic-color: #8e24aa;
            --ans-color: #2e7d32;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            margin: 0;
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        #sidebar {
            width: 340px;
            background-color: var(--sidebar-bg);
            padding: 1.5rem;
            box-shadow: 4px 0 15px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
            gap: 1rem;
            z-index: 10;
            overflow-y: auto;
        }

        h2 { color: var(--accent-color); margin: 0; font-size: 1.4rem; }
        
        .section {
            background: #fff0f3;
            padding: 12px;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .label-title { font-weight: bold; font-size: 0.8rem; text-transform: uppercase; color: #880e4f; }

        .checkbox-group { display: flex; flex-direction: column; gap: 5px; font-size: 0.85rem; }
        
        button {
            padding: 1rem;
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: 12px;
            font-weight: bold;
            cursor: pointer;
            transition: 0.2s;
        }

        button:hover { filter: brightness(1.1); }

        #main-area {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: radial-gradient(circle, #ffffff 0%, #ffebee 100%);
        }

        #card {
            background: var(--card-bg);
            width: 85%;
            max-width: 800px;
            height: 550px;
            border-radius: 40px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border: 10px solid white;
            padding: 40px;
            text-align: center;
        }

        #cat-title { font-size: 1.2rem; text-transform: uppercase; color: var(--text-muted); font-weight: bold; margin-bottom: 10px;}
        #problem { font-size: 4rem; font-weight: 800; margin: 0; }
        
        #logic-bridge { 
            font-size: 2rem; 
            color: var(--logic-color); 
            font-weight: 600; 
            margin: 20px 0;
            background: #f3e5f5;
            padding: 15px 30px;
            border-radius: 20px;
            visibility: hidden;
            max-width: 90%;
        }

        #answer {
            font-size: 3.5rem;
            color: var(--ans-color);
            font-weight: 800;
            visibility: hidden;
        }

        .visible { visibility: visible !important; }
        kbd { background: #333; color: white; padding: 2px 6px; border-radius: 4px; }
    </style>
</head>
<body>

    <div id="sidebar">
        <h2>Tailor's Measure</h2>
        
        <div class="section">
            <span class="label-title">Categories</span>
            <div class="checkbox-group" id="catGroup">
                <label><input type="checkbox" value="distance" checked> Distance / Length</label>
                <label><input type="checkbox" value="time" checked> Time</label>
                <label><input type="checkbox" value="volume" checked> Volume (L, m¬≥, cm¬≥)</label>
                <label><input type="checkbox" value="weight" checked> Weight / Mass</label>
                <label><input type="checkbox" value="currency" checked> Denominations (Lac, Mn)</label>
            </div>
        </div>

        <div class="section">
            <span class="label-title">Unit Systems</span>
            <div class="checkbox-group">
                <label><input type="checkbox" id="siCheck" checked> SI Units (Metric)</label>
                <label><input type="checkbox" id="nonSiCheck" checked> Non-SI (Imperial/Customary)</label>
            </div>
        </div>

        <button onclick="newProblem()">New Measurement</button>
        
        <div style="margin-top: auto; font-size: 0.8rem; color: #666;">
            Goal: Convert the top value to the requested unit.<br><br>
            Press <kbd>‚Üì</kbd> for logic and answer.
        </div>
    </div>

    <div id="main-area">
        <div id="card">
            <div id="cat-title">DISTANCE</div>
            <div id="problem">1.5 meters = ? cm</div>
            <div id="logic-bridge">Think: 1m = 100cm, so 1.5 √ó 100</div>
            <div id="answer">150 cm</div>
        </div>
    </div>

    <script>
        let currentStep = 0;
        const data = {
            distance: [
                { f: "meters", t: "cm", m: 100, si: true },
                { f: "km", t: "meters", m: 1000, si: true },
                { f: "meters", t: "mm", m: 1000, si: true },
                { f: "inches", t: "cm", m: 2.54, si: false },
                { f: "feet", t: "inches", m: 12, si: false },
                { f: "yards", t: "feet", m: 3, si: false }
            ],
            time: [
                { f: "hours", t: "minutes", m: 60, si: true },
                { f: "minutes", t: "seconds", m: 60, si: true },
                { f: "days", t: "hours", m: 24, si: true },
                { f: "weeks", t: "days", m: 7, si: true }
            ],
            volume: [
                { f: "liters", t: "ml", m: 1000, si: true },
                { f: "liters", t: "cm¬≥", m: 1000, si: true },
                { f: "m¬≥", t: "liters", m: 1000, si: true },
                { f: "dm¬≥", t: "liters", m: 1, si: true },
                { f: "gallons", t: "liters", m: 3.785, si: false }
            ],
            weight: [
                { f: "kg", t: "grams", m: 1000, si: true },
                { f: "grams", t: "mg", m: 1000, si: true },
                { f: "tonnes", t: "kg", m: 1000, si: true },
                { f: "pounds", t: "ounces", m: 16, si: false },
                { f: "kg", t: "pounds", m: 2.204, si: false }
            ],
            currency: [
                { f: "Lac", t: "Thousands", m: 100, si: false },
                { f: "Million", t: "Lacs", m: 10, si: false },
                { f: "Crore", t: "Millions", m: 10, si: false },
                { f: "Billion", t: "Crores", m: 100, si: false }
            ]
        };

        function newProblem() {
            currentStep = 0;
            document.getElementById('logic-bridge').classList.remove('visible');
            document.getElementById('answer').classList.remove('visible');

            const selectedCats = Array.from(document.querySelectorAll('#catGroup input:checked')).map(c => c.value);
            const useSi = document.getElementById('siCheck').checked;
            const useNonSi = document.getElementById('nonSiCheck').checked;

            if (selectedCats.length === 0) return alert("Select at least one category!");

            // Filter pool
            let pool = [];
            selectedCats.forEach(cat => {
                data[cat].forEach(unit => {
                    if ((unit.si && useSi) || (!unit.si && useNonSi)) {
                        pool.push({ ...unit, cat: cat.toUpperCase() });
                    }
                });
            });

            if (pool.length === 0) return alert("No units match your settings!");

            const unit = pool[Math.floor(Math.random() * pool.length)];
            const val = (Math.random() * 10 + 1).toFixed(unit.m > 100 ? 0 : 1);
            const result = (val * unit.m).toFixed(unit.m % 1 === 0 ? 0 : 2);

            document.getElementById('cat-title').innerText = unit.cat;
            document.getElementById('problem').innerText = `${val} ${unit.f} = ? ${unit.t}`;
            document.getElementById('logic-bridge').innerText = `Think: 1 ${unit.f} = ${unit.m} ${unit.t}`;
            document.getElementById('answer').innerText = `${result} ${unit.t}`;
        }

        function handleStep() {
            if (currentStep === 0) {
                document.getElementById('logic-bridge').classList.add('visible');
                currentStep = 1;
            } else if (currentStep === 1) {
                document.getElementById('answer').classList.add('visible');
                currentStep = 2;
            } else {
                newProblem();
            }
        }

        window.addEventListener('keydown', (e) => {
            if (e.key === "ArrowDown") {
                e.preventDefault();
                handleStep();
            }
        });

        newProblem();

		/** * ISHI MATH SUITE POWER-UP v3 (Final)
		 * Features: Clean History (1 row/Q), Dynamic Sidebar Count, Tablet Button
		 */

		(function() {
			const sidebar = document.getElementById('sidebar');
			const card = document.getElementById('card');

			// 1. Setup UI Elements
			const counterDiv = document.createElement('div');
			counterDiv.id = 'q-counter-display';
			counterDiv.style = "font-size: 1.2rem; font-weight: bold; color: #888; margin-bottom: 10px; font-family: sans-serif;";
			counterDiv.innerText = "Question: #1";
			card.prepend(counterDiv);

			const historyLink = document.createElement('a');
			historyLink.id = 'history-link-main';
			historyLink.style = "margin-top: auto; font-size: 0.85rem; color: var(--accent-color); text-decoration: underline; cursor: pointer; display: block; padding-top: 20px;";
			historyLink.innerText = "üìú View Session History (0)";
			sidebar.appendChild(historyLink);

			const nextBtn = document.createElement('button');
			nextBtn.style = "position: fixed; bottom: 30px; right: 30px; padding: 15px 40px; font-size: 1.2rem; background: var(--accent-color); color: white; border: none; border-radius: 50px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); cursor: pointer; z-index: 1000;";
			nextBtn.innerText = "Next Step ‚ûî";
			document.body.appendChild(nextBtn);

			// 2. Logic & History Tracking
			let qCount = 1;
			let sessionHistory = [];
			let currentProblemCache = "";

			window.masterStep = function() {
				const probEl = document.getElementById('problem') || document.getElementById('problem-text');
				const ansEl = document.getElementById('answer');
				
				// State check using visibility
				const isAnswerHidden = (window.getComputedStyle(ansEl).visibility === 'hidden' || !ansEl.classList.contains('visible'));

				if (isAnswerHidden) {
					// STEP 1: Reveal Answer
					currentProblemCache = probEl.innerText; // Capture question text
					if (typeof handleStep === 'function') handleStep();
				} else {
					// STEP 2: Save current result before moving to next question
					sessionHistory.push({
						no: qCount,
						prob: currentProblemCache,
						ans: ansEl.innerText
					});
					
					// Update sidebar count immediately
					historyLink.innerText = `üìú View Session History (${sessionHistory.length})`;

					// Move to next question
					if (typeof handleStep === 'function') handleStep();
					qCount++;
					counterDiv.innerText = `Question: #${qCount}`;
				}
			};

			// 3. Bindings & Events
			window.addEventListener('keydown', (e) => {
				if (e.key === "ArrowDown") {
					e.preventDefault();
					window.masterStep();
				}
			}, true);

			nextBtn.addEventListener('click', (e) => {
				e.preventDefault();
				window.masterStep();
			});

			historyLink.addEventListener('click', (e) => {
				e.preventDefault();
				if (sessionHistory.length === 0) return alert("No questions completed yet!");
				
				let report = `--- Session History (Total: ${sessionHistory.length}) ---\n\n`;
				sessionHistory.forEach(item => {
					report += `Q${item.no}: ${item.prob} = ${item.ans}\n`;
				});
				alert(report);
			});
		})();

		(function() {
			// 1. Create the Toggle Button
			const toggleBtn = document.createElement('button');
			toggleBtn.id = 'menu-toggle';
			toggleBtn.innerHTML = '‚ò∞ Settings';
			document.body.prepend(toggleBtn);

			const sidebar = document.getElementById('sidebar');

			// 2. Toggle Sidebar Function
			toggleBtn.onclick = function(e) {
				e.stopPropagation();
				sidebar.classList.toggle('open');
				toggleBtn.innerHTML = sidebar.classList.contains('open') ? '‚úï Close' : '‚ò∞ Settings';
			};

			// 3. Close sidebar if user taps the main area (outside)
			document.getElementById('main-area').onclick = function() {
				if (sidebar.classList.contains('open')) {
					sidebar.classList.remove('open');
					toggleBtn.innerHTML = '‚ò∞ Settings';
				}
			};
		})();

/** * ISHI MATH SUITE: IMMERSIVE FULL-SCREEN POWER-UP 
 * Fixes: Overflowing answers, zooming issues, and adds Full-Screen toggle.
 */

(function() {
    // 1. Force the page to fit the viewport and disable accidental zooming
    const meta = document.createElement('meta');
    meta.name = "viewport";
    meta.content = "width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no";
    document.getElementsByTagName('head')[0].appendChild(meta);

    // 1. Navigation Icons and Buttons Container
    const navIcons = document.createElement('div');
    navIcons.id = 'nav-icons';
    navIcons.style = "position: fixed; top: 15px; right: 250px; z-index: 4000; display: flex; gap: 10px;";
    
    const homeLink = document.createElement('a');
    homeLink.href = 'index.html';
    homeLink.style = "display: block; padding: 10px 15px; background: rgba(0,0,0,0.5); color: white; border: none; border-radius: 8px; font-size: 0.9rem; text-decoration: none; cursor: pointer;";
    homeLink.innerHTML = 'üè†<span class="nav-text"> Home</span>';
    homeLink.title = 'Home';
    
    const aboutLink = document.createElement('a');
    aboutLink.href = 'about.html';
    aboutLink.style = "display: block; padding: 10px 15px; background: rgba(0,0,0,0.5); color: white; border: none; border-radius: 8px; font-size: 0.9rem; text-decoration: none; cursor: pointer;";
    aboutLink.innerHTML = '‚ÑπÔ∏è<span class="nav-text"> About</span>';
    aboutLink.title = 'About';
    
    // Create donate button within nav container
    const donateLink = document.createElement('a');
    donateLink.href = 'donate.html';
    donateLink.style = "display: block; padding: 10px 15px; background: rgba(255,165,0,0.9); color: white; border: none; border-radius: 8px; font-size: 0.9rem; text-decoration: none; cursor: pointer; font-weight: bold;";
    donateLink.innerHTML = '<span class="desktop-text">‚òï Donate ‚Çπ99</span><span class="mobile-text">‚òï‚Çπ99</span>';
    donateLink.title = 'Support with a coffee';
    
    // Create USD donate button within nav container
    const donateUsdLink = document.createElement('a');
    donateUsdLink.href = 'donate_usd.html';
    donateUsdLink.style = "display: block; padding: 10px 15px; background: rgba(34,197,94,0.9); color: white; border: none; border-radius: 8px; font-size: 0.9rem; text-decoration: none; cursor: pointer; font-weight: bold;";
    donateUsdLink.innerHTML = '<span class="desktop-text">üíµ Donate USD</span><span class="mobile-text">$USD</span>';
    donateUsdLink.title = 'International support';
    
    // Create fullscreen button within nav container
    const fsBtn = document.createElement('button');
    fsBtn.id = 'fs-toggle';
    fsBtn.innerHTML = '<span class="desktop-text">‚õ∂ Full Screen</span><span class="mobile-text">‚õ∂</span>';
    fsBtn.style = "display: block; padding: 10px 15px; background: rgba(0,0,0,0.5); color: white; border: none; border-radius: 8px; font-size: 0.9rem; cursor: pointer;";
    
    navIcons.appendChild(homeLink);
    navIcons.appendChild(aboutLink);
    navIcons.appendChild(donateLink);
    navIcons.appendChild(donateUsdLink);
    navIcons.appendChild(fsBtn);
    document.body.appendChild(navIcons);

    // 3. Full Screen Logic
    fsBtn.onclick = function() {
        if (!document.fullscreenElement) {
            document.documentElement.requestFullscreen().catch(err => {
                alert(`Error attempting to enable full-screen mode: ${err.message}`);
            });
            fsBtn.innerHTML = '<span class="desktop-text">‚úï Exit Full Screen</span><span class="mobile-text">‚úï</span>';
        } else {
            document.exitFullscreen();
            fsBtn.innerHTML = '<span class="desktop-text">‚õ∂ Full Screen</span><span class="mobile-text">‚õ∂</span>';
        }
    };

    // 4. "Auto-Scale" Logic: Shrinks the card if it exceeds the screen height
    function adjustScale() {
        const card = document.getElementById('card');
        const main = document.getElementById('main-area');
        if (!card || !main) return;

        // Reset scale to calculate true size
        card.style.transform = 'scale(1)';
        
        const padding = 40; // Safety margin
        const availableHeight = window.innerHeight - padding;
        const cardHeight = card.offsetHeight;

        if (cardHeight > availableHeight) {
            const scaleFactor = availableHeight / cardHeight;
            card.style.transform = `scale(${scaleFactor})`;
            card.style.transformOrigin = 'center center';
        }
    }

    // Run on load and whenever the screen orientation changes
    window.addEventListener('resize', adjustScale);
    window.addEventListener('orientationchange', adjustScale);
    setTimeout(adjustScale, 100); // Initial check
})();

    </script>
</body>
</html>